name: Build

inputs:
  go_version:
    required: true

runs:
  using: composite
  steps:
    - name: Checkout
      uses: actions/checkout@v2

    - name: Checkout iPXE
      uses: actions/checkout@v2
      with:
        path: ipxe
        repository: ipxe/ipxe
        ref: bc5c612f756b11c08e5e1eaeee3c1fd91252534d
        fetch-depth: 0 # we need the entire history to build iPXE

    - name: Setup Go
      uses: actions/setup-go@v3
      with:
        go-version: ${{ inputs.go_version }}

    - name: Go generate
      run: go generate ./...
      shell: bash
